{"version":3,"file":"react-native-event.min.js","sources":["../../src/native.tsx","../../src/index.tsx"],"sourcesContent":["import React from 'react';\nimport ReactNative from 'react-native';\n\nexport type EventTypes = ReactNative.GestureResponderEvent;\nexport type HandlerType = (event: EventTypes) => void;\n\nexport type EventContextType = {\n  subscribe: (handler: HandlerType) => void;\n};\n\nexport const EventContext = React.createContext<EventContextType | undefined>(\n  undefined,\n);\n\nexport type EventProviderProps = {\n  events?: string[];\n  children?: React.ReactNode;\n};\nexport function EventProvider({ children }: EventProviderProps) {\n  const [handlers] = React.useState<HandlerType[]>([]);\n  function onEvent(event: EventTypes) {\n    handlers.forEach((subscriber) => subscriber(event));\n  }\n  function subscribe(handler: HandlerType) {\n    handlers.push(handler);\n    return () => handlers.splice(handlers.indexOf(handler), 1);\n  }\n\n  return (\n    <EventContext.Provider value={{ subscribe }}>\n      <ReactNative.View\n        style={ReactNative.StyleSheet.absoluteFill}\n        onStartShouldSetResponderCapture={(event:ReactNative.GestureResponderEvent) => {\n          event.persist();\n          onEvent(event);\n          return false;\n        }}\n      >\n        {children}\n      </ReactNative.View>\n    </EventContext.Provider>\n  );\n}\n\nexport function useEvent(handler, dependencies) {\n  const { subscribe } = React.useContext(EventContext);\n  React.useEffect(\n    () => subscribe(handler),\n    [subscribe, handler].concat(dependencies),\n  );\n}\n\nexport default {\n  EventContext,\n  EventProvider,\n  useEvent\n}\n","// define window to avoid conflicts with dom and react-native types\ndeclare global {\n  interface Document {}\n  interface Window {\n    document: Document;\n  }\n}\ndeclare const window: Window & typeof globalThis;\n\n// @ts-ignore\nimport native from './native.tsx';\nimport type {EventTypes as EventTypesNative, HandlerType as HandlerTypeNative, EventContextType as EventContextTypeNative} from './native';\nimport dom from 'react-dom-event';\nimport type {EventTypes as EventTypesDOM, HandlerType as HandlerTypeDOM, EventContextType as EventContextTypeDOM} from 'react-dom-event';\n\nexport type EventTypes = EventTypesNative | EventTypesDOM;\nexport type HandlerType = HandlerTypeNative | HandlerTypeDOM;\nexport type EventContextType = EventContextTypeNative | EventContextTypeDOM;\n\nlet EventContextUniversal:\n  | typeof native.EventContext\n  | typeof dom.EventContext\n  | null = null;\nlet EventProviderUniversal:\n  | typeof native.EventProvider\n  | typeof dom.EventProvider\n  | null = null;\nlet useEventUniversal: typeof native.useEvent | typeof dom.useEvent | null =\n  null;\nif (window?.document) {\n  EventContextUniversal = dom.EventContext;\n  EventProviderUniversal = dom.EventProvider;\n  useEventUniversal = dom.useEvent;\n} else {\n  EventContextUniversal = native.EventContext;\n  EventProviderUniversal = native.EventProvider;\n  useEventUniversal = native.useEvent;\n}\nexport const EventContext = EventContextUniversal;\nexport const EventProvider = EventProviderUniversal;\nexport const useEvent = useEventUniversal;\n"],"names":["_arrayLikeToArray","arr","len","EventContext","React","createContext","undefined","native","EventProvider","param","children","handlers","_slicedToArray","useState","createElement","Provider","value","subscribe","handler","push","splice","indexOf","ReactNative","View","style","StyleSheet","absoluteFill","onStartShouldSetResponderCapture","event","persist","forEach","subscriber","onEvent","useEvent","dependencies","useContext","useEffect","concat","EventContextUniversal","EventProviderUniversal","useEventUniversal","window","document","dom"],"mappings":"kfAAA,SAAAA,EAAAC,EAAAC,+7BAUO,IAAMC,EAAeC,EAAK,QAACC,mBAChCC,GAyCa,IAAAC,EAAA,CACbJ,aAAAA,EACAK,cApCK,SAAuBC,GAAA,IAAEC,EAAFD,EAAEC,SACvBC,EAA6CC,EAAjCR,EAAK,QAACS,SAAwB,IAAG,MASpD,OACET,UAAAU,cAACX,EAAaY,SAAQ,CAACC,MAAO,CAAEC,UANlC,SAAmBC,GAEjB,OADAP,EAASQ,KAAKD,GACP,kBAAMP,EAASS,OAAOT,EAASU,QAAQH,GAAU,OAKtDd,UAACkB,cAAAA,EAAW,QAACC,KAAI,CACfC,MAAOF,EAAAA,QAAYG,WAAWC,aAC9BC,iCAAkC,SAACC,GAGjC,OAFAA,EAAMC,UAbd,SAAiBD,GACfjB,EAASmB,SAAQ,SAACC,UAAeA,EAAWH,MAatCI,CAAQJ,IACD,IAGRlB,KAiBPuB,SAXK,SAAkBf,EAASgB,GAChC,IAAMjB,EAAgBb,EAAK,QAAC+B,WAAWhC,GAA/Bc,UACRb,EAAK,QAACgC,WACJ,kBAAMnB,EAAUC,KAChB,CAACD,EAAWC,GAASmB,OAAOH,MC7B5BI,EAGO,KACPC,EAGO,KACPC,EACF,MACEC,OAAAA,aAAgB,IAAhBA,YAAAA,EAAAA,OAAQC,WACVJ,EAAwBK,EAAG,QAACxC,aAC5BoC,EAAyBI,EAAG,QAACnC,cAC7BgC,EAAoBG,EAAG,QAACV,WAExBK,EAAwB/B,EAAOJ,aAC/BoC,EAAyBhC,EAAOC,cAChCgC,EAAoBjC,EAAO0B,UAEhB9B,IAAAA,EAAemC,EACf9B,EAAgB+B,EAChBN,EAAWO"}