{"version":3,"file":"react-native-event.js","sources":["../../src/index.ts"],"sourcesContent":["import { createContext, createElement, useContext, useEffect, useState } from 'react';\nimport type { ReactNode } from 'react';\nimport { StyleSheet, View } from 'react-native';\nimport type { GestureResponderEvent } from 'react-native';\n\nexport type EventTypes = GestureResponderEvent;\nexport type HandlerType = (event: EventTypes) => void;\n\nexport type EventContextType = {\n  subscribe: (handler: HandlerType) => void;\n};\n\nexport const EventContext = createContext<EventContextType | undefined>(undefined);\n\nexport type EventProviderProps = {\n  events?: string[];\n  children?: ReactNode;\n};\nexport function EventProvider({ children }: EventProviderProps) {\n  const state = useState<HandlerType[]>([]);\n  const handlers = state[0];\n\n  function onEvent(event: EventTypes) {\n    handlers.forEach((subscriber) => subscriber(event));\n  }\n  function subscribe(handler: HandlerType) {\n    handlers.push(handler);\n    return () => handlers.splice(handlers.indexOf(handler), 1);\n  }\n\n  return createElement(\n    EventContext.Provider,\n    { value: { subscribe } },\n    createElement(\n      View,\n      {\n        style: StyleSheet.absoluteFill,\n        onStartShouldSetResponderCapture: (event) => {\n          event.persist();\n          onEvent(event);\n          return false;\n        },\n      },\n      children\n    )\n  );\n}\n\nexport function useEvent(handler, dependencies) {\n  const context = useContext(EventContext);\n  if (!context) {\n    throw new Error('react-native-event: subscribe not found on context. You might be missing the EventProvider or have multiple instances of react-native-event');\n  }\n\n  // biome-ignore lint/correctness/useExhaustiveDependencies: <explanation>\n  useEffect(() => context.subscribe(handler), [context.subscribe, handler].concat(dependencies));\n}\n"],"names":["EventContext","createContext","undefined","EventProvider","children","onEvent","event","handlers","forEach","subscriber","subscribe","handler","push","splice","indexOf","state","useState","createElement","Provider","value","View","style","StyleSheet","absoluteFill","onStartShouldSetResponderCapture","persist","useEvent","dependencies","context","useContext","Error","useEffect","concat"],"mappings":";;;;;;MAYaA,YAAY,GAAGC,mBAAa,CAA+BC,SAAS,EAAE;EAM5E,SAASC,aAAa,CAAC,KAAgC,EAAE;EAAlC,IAAA,IAAEC,QAAQ,GAAV,KAAgC,CAA9BA,QAAQ,CAAsB;EAInDC,IAAAA,IAAAA,OAAO,GAAhB,SAASA,OAAO,CAACC,KAAiB,EAAE;EAClCC,QAAAA,QAAQ,CAACC,OAAO,CAAC,SAACC,UAAU,EAAA;qBAAKA,UAAU,CAACH,KAAK,CAAC,CAAA;EAAA,SAAA,CAAC,CAAC;EACrD,KAAA,CAAA;EACQI,IAAAA,IAAAA,SAAS,GAAlB,SAASA,SAAS,CAACC,OAAoB,EAAE;EACvCJ,QAAAA,QAAQ,CAACK,IAAI,CAACD,OAAO,CAAC,CAAC;UACvB,OAAO,WAAA;qBAAMJ,QAAQ,CAACM,MAAM,CAACN,QAAQ,CAACO,OAAO,CAACH,OAAO,CAAC,EAAE,CAAC,CAAC,CAAA;WAAA,CAAC;EAC5D,KAAA,CAAA;EATD,IAAA,IAAMI,KAAK,GAAGC,cAAQ,CAAgB,EAAE,CAAC,CAAC;EAC1C,IAAA,IAAMT,QAAQ,GAAGQ,KAAK,CAAC,CAAC,CAAC,CAAC;EAU1B,IAAA,OAAOE,mBAAa,CAClBjB,YAAY,CAACkB,QAAQ,EACrB;EAAEC,QAAAA,KAAK,EAAE;EAAET,YAAAA,SAAS,EAATA,SAAS;EAAE,SAAA;OAAE,EACxBO,mBAAa,CACXG,gBAAI,EACJ;UACEC,KAAK,EAAEC,sBAAU,CAACC,YAAY;UAC9BC,gCAAgC,EAAE,SAAClB,KAAK,EAAK;cAC3CA,KAAK,CAACmB,OAAO,EAAE,CAAC;cAChBpB,OAAO,CAACC,KAAK,CAAC,CAAC;EACf,YAAA,OAAO,KAAK,CAAC;EACd,SAAA;OACF,EACDF,QAAQ,CACT,CACF,CAAC;EACH,CAAA;EAEM,SAASsB,QAAQ,CAACf,OAAO,EAAEgB,YAAY,EAAE;EAC9C,IAAA,IAAMC,OAAO,GAAGC,gBAAU,CAAC7B,YAAY,CAAC,CAAC;MACzC,IAAI,CAAC4B,OAAO,EAAE;EACZ,QAAA,MAAM,IAAIE,KAAK,CAAC,6IAA6I,CAAC,CAAC;EAChK,KAAA;;EAGDC,IAAAA,eAAS,CAAC,WAAA;EAAMH,QAAAA,OAAAA,OAAO,CAAClB,SAAS,CAACC,OAAO,CAAC,CAAA;OAAA,EAAE;EAACiB,QAAAA,OAAO,CAAClB,SAAS;UAAEC,OAAO;EAAC,KAAA,CAACqB,MAAM,CAACL,YAAY,CAAC,CAAC,CAAC;EAChG;;;;;;;;;;;;"}